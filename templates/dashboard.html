<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dashboard - Items Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Items created by day</h1>
  <canvas id="itemsChart" width="800" height="400"></canvas>

  <script>
    async function fetchReport() {
      const res = await fetch('/api/reports/items-by-day/');
      return await res.json();
    }

    (async () => {
      const data = await fetchReport();
      const labels = data.map(d => d.day);
      const counts = data.map(d => d.count);
      const totals = data.map(d => parseFloat(d.total || 0));

      const ctx = document.getElementById('itemsChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            { label: 'Items count', data: counts, yAxisID: 'y' },
            { label: 'Total price (USD)', data: totals, type: 'line', yAxisID: 'y1' }
          ]
        },
        options: {
          scales: {
            y: { type: 'linear', position: 'left' },
            y1: { type: 'linear', position: 'right' }
          }
        }
      });
    })();
  </script>
</body>
</html>